<presentation language="ja">
<slide page="1">
<body>
<p>
付録２
2次元アフィン変換
直交変換
たたみ込み
</p>
</body>
</slide>
<slide page="2">
<body>
<p>
１．2次元のアフィン変換
座標(x’,y’)を(x,y)に移すことを２次元での変換．特に，変換が
と書けるとき，アフィン変換，アフィン変換は，その１次の項による
変換
と０次の項による変換
</p>
</body>
</slide>
<slide page="3">
<body>
<p>
アフィン変換
０次の項は平行移動
１次の項は座標(x’, y’) をベクトルと考えて
とすれば
このようなもの２次元ベクトルの線形写像
</p>
</body>
</slide>
<slide page="4">
<body>
<p>
線形写像
２次元の線形写像は行列
として表すことが可能．x, y方向の単位ベクトル
が，この変換により
に移される．これらが２次元の空間を張る基底になるには行列式が
を満たさなければならない．
</p>
</body>
</slide>
<slide page="5">
<body>
<p>
恒等写像
• 恒等写像
– x’, y’ を同じ値に変換するものである
アフィン変換で，１次の項が恒等写像で，０次の項
が有限の場合は単なる平行移動となる．
</p>
</body>
</slide>
<slide page="6">
<body>
<p>
鏡像
• 鏡像
– ある軸を中心に対称の位置に座標が変換される．図では
x 軸を対称軸とする場合を示す
</p>
</body>
</slide>
<slide page="7">
<body>
<p>
向きを変える写像
• 向きを変える写像
– 恒等写像のときは読むことが出来た字は，傾けてみても
読むことは出来ない場合
– アフィン変換の場合行列式が
– ならば向きを変える写像
– それに対して行列式が正の場合を向きを保つ写像
</p>
</body>
</slide>
<slide page="8">
<body>
<p>
回転
• 反時計回りにθの回転
で与えられる． θ= π/3 の場合を図に示す．
• アフィン変換のうち，
– 回転
– 鏡像
– 平行移動
の３つの変換は２点の距離を変えないため等長変換と呼ばれる
</p>
</body>
</slide>
<slide page="9">
<body>
<p>
伸縮
a > 0; d > 0 のとき
はx 軸方向へ倍率a，y 軸方向へ倍率d での伸縮となる．
– 倍率が1 より大きければ拡大
– 1 より小さければ縮小
– a = d のときは変換された図形はもとの図形と相似
一般に行列式が正である対称行列
による変換はある直交した２つ
の軸方向への伸縮
</p>
</body>
</slide>
<slide page="10">
<body>
<p>
一般の線形変換
• 一般の向きを保つ２次元の線形変換
– 伸縮と回転変換の組み合わせで表現可能
– アフィン変換は“線形変換+平行移動” で表現可能
– 線形変換の性質を考慮すれば結局
• アフィン変換= 回転×伸縮+ 平行移動
</p>
</body>
</slide>
<slide page="11">
<body>
<p>
同次座標系
• アフィン変換では
– 処理が線形変換部分である行列演算と平行移動部分であるベクトル
の和の部分がある．このとき，次数を１つ上げて
– と座標を表現することでアフィン変換は線形変換に帰着
– 座標(u，v，w) に対して（ただしu = v = w = 0 を除く）線形変換を許し，
その比u : v : wが等しいものを同一視する幾何学を（２次元）射影幾何
– 特にw ≠ 0 ならば，座標値としては結局(p = u/w, q = v/w) の２変数
を持つことになる．
– ２次元アフィン幾何は２次元射影幾何のうちu = x，v = y，w = 1の特別
な場合である
</p>
</body>
</slide>
<slide page="12">
<body>
<p>
２．直交変換（実数の場合）
• 任意のn×nの実行列をA = (aij )，任意のn次元実ベクトルをx，y とする．このと
きベクトルx とベクトルAyの内積は，
• ここで，AtはAの転置行列としている．ここで行列A が任意のベクトルx，y に対し
て内積を保存するとする．
• このような行列A を直交行列という．内積が保存される場合
が常に成り立つことから
である．これは，行列A のj 番目の列ベクトルをaj とすれば，この各列ベクトルは正規
直交である．
</p>
</body>
</slide>
<slide page="13">
<body>
<p>
直交変換（実数の場合）
• ２次元の場合
– 向きを保つ直交行列が回転となる．２次元の直交行列で
は４つのパラメータa, b, c,dが出てくるが正規直交性によ
り３つの制約条件がつき，実際には１つのパラメータで表
現できる．これが２次元の線形変換で出てきた角度θで
ある．
– 通常，行列の積は可換ではないが２次元の回転行列の
積は可換である．
</p>
</body>
</slide>
<slide page="14">
<body>
<p>
直交変換（実数の場合）
• ３次元の場合
– 直交行列を
として表す．
この行列の行列式が1 である場合，向きが保たれ３次元の回転となる．正規直交系の制約から６つ
の制約が入るので９つのパラメータはあるが，３次元の回転は３変数で表現できることが推測される．
実際x,y,zそれぞれの軸の回転を
とすれば一般の回転は，
で表すことが出来る．ただし，２次元の回転と違い，回転行列は一般には可換ではないので例えば
一般には
である．また，角度θx, θy, θzが決まれば，回転が定まるが，逆にある回転（すなわち回転行列）
に対して角度は一意には定まらない．
</p>
</body>
</slide>
<slide page="15">
<body>
<p>
直交変換（実数の場合）
• 離散コサイン変換
は積和演算であり，行列形式で容易に表すことが出来る
この行列の列ベクトルは互いに正規直交しているので直
交行列である．よって，この行列の転置行列は逆行列に
なり，逆変換に対応している．
</p>
</body>
</slide>
<slide page="16">
<body>
<p>
直交変換（複素数の場合）
任意のn×nの複素行列をA = (aij )，任意のn 次元複素ベクトルをx，y とする．このときベクトルx とベクトル
Ay の内積は，
となる．ここで，AtはA の転置行列，A *はA の各成分の複素共役としている．このような転置で複素共役を
エルミート共役といい
ここで行列A が任意のベクトルx，yに対して内積を保存するとする
このような行列A をユニタリ行列という．内積が保存される場合
が常に成り立つことから
である．
これは，行列A のj 番目の列ベクトルをaj とすれば，この各列ベクトルは正規直交であることを意味する．
</p>
</body>
</slide>
<slide page="17">
<body>
<p>
直交変換（複素数の場合）
• 離散フーリエ変換
は積和演算であり．行列形式で表すことが可能
この行列の列ベクトルは互いに複素ベクトルとして正規直交であるので，ユニタリ行列
である．よって，この逆行列はエルミート共役になり．逆変換に対応している．
</p>
</body>
</slide>
<slide page="18">
<body>
<p>
デルタ関数
• 複素数値関数f(x), g(x) をベクトルと考えたとき，その内積
は
であった．ここではf, g は二乗可積分
かつ，十分滑らかであるとする．導関数との内積は
</p>
</body>
</slide>
<slide page="19">
<body>
<p>
• なる関係がある．ここで有限次元のベクトルについて復習する．有限次元n のベクトルの正
規直交基底がe1, e2,…, en であるとすると，任意のベクトルv は
と表すことが出来る．このときi 番目の成分は
となる．このアナロジーで関数の連続的な引数をベクトルの添字と考え，関数f をx = a での
成分がf(a) であるベクトルと考えることにする．x = a での基底ベクトルea とすると，
となる．関数の内積の定義から
となる関数δ(x)があれば，
とすることで基底としての役割を果たす
デルタ関数
</p>
</body>
</slide>
<slide page="20">
<body>
<p>
デルタ関数
• このような関数δ(x) をデルタ関数或は単位インパルス関数といい，厳密
には通常の関数ではないが，例えば，ε > 0 として関数
のε→ 0 での極限と考えることが出来る．
</p>
</body>
</slide>
<slide page="21">
<body>
<p>
デルタ関数
• デルタ関数の導関数δ’は，通常の導関数の内積を
拡張して解釈すると
となることから，これを定義とする．また，ヘビサイド
(Heaviside) 関数，或は単位ステップ関数と呼ばれ
る次の関数を考える．
</p>
</body>
</slide>
<slide page="22">
<body>
<p>
ヘビサイド関数
ヘビサイド関数の導関数θ’の内積をとると
となることから，θ’ =  δであることが分かる．逆に見ればデルタ関数の積分はヘ
ビサイド関数になる．
</p>
</body>
</slide>
<slide page="23">
<body>
<p>
３．たたみ込み
• 関数f,gのたたみ込みは
で定義
• たたみ込みの性質
– 交換法則
</p>
</body>
</slide>
<slide page="24">
<body>
<p>
たたみ込み
• たたみ込みの性質
– 結合法則
– 分配法則
• このような数学的な性質はたたみ込み代数と呼ばれ，数の間の積と類似
の性質があることが分かる．
</p>
</body>
</slide>
<slide page="25">
<body>
<p>
デルタ関数の微分
</p>
</body>
</slide>
<slide page="26">
<body>
<p>
デルタ関数とたたみ込み
• 一般の関数f とデルタ関数のたたみ込みをすると
となり，もとの関数fのままである．このようにデルタ
関数はたたみ込みで，単位元としての役割を果たす．
また，デルタ関数の導関数δ’ と畳込むと
となり，fの導関数を求めることになる．
</p>
</body>
</slide>
<slide page="27">
<body>
<p>
フーリエ変換とたたみ込み
• たたみ込みをフーリエ変換すると
となる．
• すなわち，たたみ込みは周波数空間では積の定数倍になる．
逆に実空間での関数の積は周波数空間ではたたみ込みに
なる．
</p>
</body>
</slide>
<slide page="28">
<body>
<p>
離散的な場合のたたみ込み
• 離散的な場合のたたみ込みも，周期関数として定義
• すなわち，F(s + N) = F(s)，G(s + N) = G(s)が成り立つ関数
に対してたたみ込み
と定義．ここで，n，mは整数，Nは正の整数とする．
</p>
</body>
</slide>
<slide page="29">
<body>
<p>
離散的な場合のたたみ込み
• 交換法則
• 結合法則
</p>
</body>
</slide>
<slide page="30">
<body>
<p>
離散的な場合のたたみ込み
• 分配法則
</p>
</body>
</slide>
<slide page="31">
<body>
<p>
離散的な場合のたたみ込み
• 単位元
– 連続な場合はたたみ込みで単位元の役割を果たしたのはデルタ関
数であった．離散的な場合にその役割を果たすものとしてクロネッ
カーのデルタがある．これは整数i,jに対して
と定義される．離散的な場合のデルタ関数を
とおけば，
が成り立つ．
</p>
</body>
</slide>
<slide page="32">
<body>
<p>
離散的な場合のたたみ込み
• 差分
–連続的な場合の微分に相当する概念が差分であ
る．ここでは差分の定義を
– この定義では差分はmに対して正の方向である
+1 との差を考えていて，m を中心として対称で
はない．差分はたたみ込みに対して
</p>
</body>
</slide>
<slide page="33">
<body>
<p>
離散的な場合のたたみ込み
• 離散フーリエ変換
• これらの性質によりたたみ込みに関する連続的な
場合の議論は多くの場合離散的な場合にも成り立
つ．
</p>
</body>
</slide>
<slide page="34">
<body>
<p>
相関
• たたみ込みと類似の概念に相関
– 関数f, g の相関は
• で定義される．相関は一般には交換法則，結合法則が成り立たない等た
たみ込みに比べて代数的に扱いが容易ではないが，関数f が実関数の
とき自分自身との相関である自己相関については次の有用な性質があ
る
• パワースペクトルをフーリエ逆変換したものが自己相関になる．周期性を
調べるために，しばしば自己相関が用いられる．
</p>
</body>
</slide>
</presentation>
