<presentation language="ja">
<slide page="1">
<body>
<p>
付録３
分布
勾配
最小二乗法
</p>
</body>
</slide>
<slide page="2">
<body>
<p>
付録：分布関数
• １変数の分布関数について
– 画像f があるとき，分布w(x) で平均化した結果はf ＊ω(-x)で与えられた．
– このことから周波数領域での振舞を知るにはω(x)のフーリエ変換が重要となるが
確率論ではしばしば特性関数(characteristic function) が用いられる．これは
で定義．実質的にはフーリエ変換と同じ
分布が平均を持つときは
で求められ，分布の位置を表す指標となる．また，分布が分散をもつときは
で計算され，分布のばらつきを表す指標となる
</p>
</body>
</slide>
<slide page="3">
<body>
<p>
一様分布
• [a,b]上の一様な密度 u([a,b]) としばしば表される．
この分布の平均は(a + b)/2，分散は(a-b)2/2 
特性関数はsinc関数となり，高周波数で値は小さくな
るものの，最後まで値が振動しているのが分かる．
</p>
</body>
</slide>
<slide page="4">
<body>
<p>
正規分布
• 理論的な考察をする場合によく用いられる
• 平均m 標準偏差σの正規分布はN(m,σ])としばし
ば表される．
特性関数も
</p>
</body>
</slide>
<slide page="5">
<body>
<p>
コーシー分布
• 平面上のある点から平面内の任意の角度に対して一様に光
が放射されたとき，それを平面上の直線で受光したときの強
度が，この分布関数
位置母数m と尺度母数sで分布を特徴づける
</p>
</body>
</slide>
<slide page="6">
<body>
<p>
勾配
x,y平面上で滑らかな二次元の実関数f(x,y) が与えられたとき，
ベクトル
をf の勾配(gradient) という．f の微分df を考えると
c を定数とするとf(x, y) = c は曲線を構成する．これを等位線
（等高線）という
</p>
</body>
</slide>
<slide page="7">
<body>
<p>
勾配
• dx，dyを等位線上を動かすと，df = 0 である．この
ことから，勾配gradfは等位線と直交していることが
わかる
</p>
</body>
</slide>
<slide page="8">
<body>
<p>
勾配
• θ方向のベクトルをl = (lcos ,lsin ) とおくと，dx = dlcos ,dy = dlsin,この
とき,方向l の微分係数は
• 勾配の方向と微分係数をとる方向が一致するとき，それぞれのベクトル
が平行となり，絶対値は最大に，勾配の方向と，微分係数を求める方向
が直交しているときは，その微分係数は0 になる
</p>
</body>
</slide>
<slide page="9">
<body>
<p>
発散
• ２次元平面でベクトルが定義されているとき
このv(x,y) をベクトル場という．ベクトル場が与えられたとき，
次のような演算
を発散と呼ぶ．発散は注目点の近傍の小領域を考えたとき
のベクトルv の入出量を表している
</p>
</body>
</slide>
<slide page="10">
<body>
<p>
ラプラシアン
• 勾配はベクトル場である．そこで，f(x，y) の勾配の発散を
考えることが出来る．
これをf のラプラシアンと言い，
と表す．ラプラシアンの絶対値が大きな値を持つのは
f(x; y) の山の頂上や谷底であり，山頂や谷底の値で
は値が小さくなる
</p>
</body>
</slide>
<slide page="11">
<body>
<p>
円のハフ変換
点(a,b) を中心として，半径r の円は
ここで半径r が既知であるとすれば，問題はノイズを含む観測された
点列(xi,yi) (i =1,…,N) から，a,b を決定することになる．
このときa, b をそれぞれ横軸と縦軸にしてパラメータ空間を作れば，
はa,b空間上で円を描く．直線のときと同様に多数決の原理から円の中心
位置が分かる
</p>
</body>
</slide>
<slide page="12">
<body>
<p>
最小二乗法の具体例
（線形変換の係数決定）
• ２次元の線形変換を例にとって説明
– ここで２次元の線形変換を
誤差が無いと仮定する場合
基準点(10, 0), (0,10) がそれぞれ(7,8),(-6,7)に移ったとする．
このとき，
を解いて，p = 0.7,q = -0.6, r = 0.8,s = 0.7
</p>
</body>
</slide>
<slide page="13">
<body>
<p>
最小二乗法の具体例
（線形変換の係数決定）
• 誤差がある場合
基準点(10,0),(0,10),(10,10) がそれぞれ(7,8), (-6,7),(0,14)
に移ったとする
このときは最小二乗法で二乗誤差の和
のp,q,r,sによる最小値を求めればよい
</p>
</body>
</slide>
<slide page="14">
<body>
<p>
Etotalの微分
が任意のdp, dq, dr, dsについて成り立たなければならない．
を解くことで，p = 0:667; q =-.633,r=0.767,s=0.667となる
最小二乗法の具体例
（線形変換の係数決定）
</p>
</body>
</slide>
<slide page="15">
<body>
<p>
最小二乗法の具体例
（線形変換の係数決定）
• 制約条件がつけられる場合
– 基準点(10, 0),(0,10),(10,10) がそれぞれ(7,8),(-6,7),(0,14)に移ったとする．
– このとき線形変換が回転であるとすると事前にわかっているとする．
を満たさなければならない．
何も制約が無ければdp,dq,dr,dsは独立に任意にとることが出来た．しかし上式の３つの制約のもとでは，
を満たさねばならず，dp,dq,dr,dsのうち独立なのは一つで，後の３つはその関数と考えることが出来る．
</p>
</body>
</slide>
<slide page="16">
<body>
<p>
最小二乗法の具体例
（線形変換の係数決定）
• この条件のもとでEtotalの最大となる点は，g1 = g2 = g3 = 0 であるので
任意λ1, λ2, λ3に対して
の最大となる点と一致する．Elagrangeの微分をとると
</p>
</body>
</slide>
<slide page="17">
<body>
<p>
最小二乗法の具体例
（線形変換の係数決定）
• ここではdp を独立dq,dr,ds を従属とする．本来ならdq,dr,dsは任意の方向に
はとれないが，パラメータλ1, λ2, λ3 は任意の定数なので，これらを調整す
ることで任意のdq,dr,dsに対して
を満たすことが出来る．すなわち，
</p>
</body>
</slide>
<slide page="18">
<body>
<p>
最小二乗法の具体例
（線形変換の係数決定）
• dpはもともと独立なので，
でなければならない．結局上の４つの方程式と３つの制約条
件から7つの変数をp,q,r,s,λ1,λ2,λ3を求める問題に帰着
する．
これを解けば，p = 0.707,q = -0.707 r= 0.707, s=-0.707
この変換例では，π/4 の回転に乱数で誤差を与えたもので，
制約条件のもと求めた係数と一致する．
このように未定の係数を用いて制約条件のある極値問題を
解く手法をラグランジュ(Lagrange)の未定係数法(method of 
undetermined coecient) という．
</p>
</body>
</slide>
</presentation>
