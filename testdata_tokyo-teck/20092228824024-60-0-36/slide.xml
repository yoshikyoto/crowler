<presentation language="ja">
<slide page="1">
<body>
<p>
知的画像処理（５） 1
特徴選択と特徴空間
</p>
</body>
</slide>
<slide page="2">
<body>
<p>
知的画像処理（５） 2
画像の処理工程
像
画
像
の
識
別
画
像
の
理
解
記
述
画
像
の
観
測
画
像
の
変
換
画
像
の
解
析
画像の表示
</p>
</body>
</slide>
<slide page="3">
<body>
<p>
知的画像処理（５） 3
画像の識別処理
特徴選択
パターンの識別に用いる特徴を決定
特徴の評価基準の目安
：誤識別率との対応づけが容易であること
：パターン成分に関して線形性があること
：距離測度の条件を満たすこと
１つの特徴概念で，すべての目安を満たす
ことは困難．
M
</p>
</body>
</slide>
<slide page="4">
<body>
<p>
知的画像処理（５） 4
特徴選択基準(1)
パターン間距離にもとづいた基準
パターン間類似度に基づいた基準
誤識別率に基づいた基準
選択された特徴 特徴ベクトル
特徴ベクトルの分布 特徴空間
識別の効率（識別率，計算時間等）を考慮した特徴空間
の構成が必要
M
</p>
</body>
</slide>
<slide page="5">
<body>
<p>
知的画像処理（５） 5
距離最小化基準
特徴評価基準の中で最も一般的．
クラス内距離が小さく，クラス間距離が大きくなる特徴を
選択すれば識別には有効
距離の種類
ユークリッド距離，
マハラノビス距離
特徴選択基準(2)
：ユークリッド距離)()(,C)(d TE mxmxx −−=2
：マハラノビス距離)()(,C)(d TM mxMmxx −−= −12
Mm,x の平均と共分散行列クラスタ未知パターン C,
</p>
</body>
</slide>
<slide page="6">
<body>
<p>
知的画像処理（５） 6
であるとする．
クラスタ共分散行列
クラスタ中心
において２つのクラスタ
,,
,,
,
21
21
21
MM
mm
CC
[ ]∑
=
−−=
=
n
i
T
ii
i
n
ni
dn
1
)ˆ)(ˆ(1
),...1(
xxxxM
M
x
は，クラスタの共分散行列
この構成されているとき，
から列ベクトル
次元個のあるクラスタが
となる．
あるいは，
に応じて
ラスタ分散が等しい場合でも，ク距離
でのユークリッドから各クラスタ中心まこのとき，ある点
),(),(
),(),(
,,
),(),,(
2
2
1
2
2
2
1
2
21
2
2
1
2
CdCd
CdCd
CdCd
MM
MM
EE
xx
xx
MM
xx
x
≥
≤
</p>
</body>
</slide>
<slide page="7">
<body>
<p>
知的画像処理（５） 7
類似度最大化基準
θcos],[ =⋅= ||||||||s
T
yx
yxyx
yx の類似度と特徴
な特徴を選択．が最も大きくなるよう
特徴選択基準
)1(],[
1 || ||
,...,NiCsD i
N
i C C
s
i i
==∑ ∑ ∑
= ∈ ∈x y
yx
x
yθ
特徴選択基準(3)
</p>
</body>
</slide>
<slide page="8">
<body>
<p>
知的画像処理（５） 8
誤識別率最小化基準
特徴空間上のパターンクラス
パターン
識別規則
率に属すると判定する確をクラスパターン ii Cxx :)(δ
T
rxxx ),...,,( 21=x
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜
⎝
⎛
=
)(
)(
)(
1
x
x
x
mδ
δ
δ M
1)(...)()( 21 =+++ xxx mδδδ
準備
),,1(, miCi L=
特徴選択基準(4)
</p>
</body>
</slide>
<slide page="9">
<body>
<p>
知的画像処理（５） 9
dxCxpxCxEjiP ijij )|()(}|)({);( ∫==→ δδδ
とされる確率：
に帰属するによって，に帰属するパターンが ji CC δ
と誤認識する確率．のパターンをのとき， ji CCji ≠
される確率は，以外のクラスに誤識別が ii CCx∈
ijjiPiP
m
j
≠→=∑
=
,);();(
1
δδ
は，に基づく平均誤識別率δ
)();()(
1
i
m
i
e CPiPP ∑
=
= δδ
：ベイズの識別規則を最小にするδδ )(eP
</p>
</body>
</slide>
<slide page="10">
<body>
<p>
知的画像処理（５） 10
この規則は次のようにも表される．
⎩⎨
⎧ >=
⎩⎨
⎧ ≤=
=
otherwise,0
)|()()|()(,1)(
,
otherwise,0
)|()()|()(,1)(
))(),(()(
1122*
2
1122*
1
*
2
*
1
*
CxpCPCxpCPx
CxpCPCxpCPx
xxx T
δ
δ
δδδ
である．は，ベイズの識別規則次の非確率的規則
（例）
∗δ
⎩⎨
⎧
≈⇒<
≈⇒≥
212
112
2
1
)()(
)()(
)|(
)|(
CxCPCP
CxCPCP
Cxp
Cxp
</p>
</body>
</slide>
<slide page="11">
<body>
<p>
知的画像処理（５） 11
特徴空間の次元数
d
3φ
2φ
1φ
L
1φ
3φ
4φ
nφ
2φ
（次元圧縮）
低次元化 高次元化
線形分離困難さの増大 線形分離可能性の増大
分類器の低コスト化 分類器の高コスト化
1φ
原特徴空間低次元特徴空間 高次元特徴空間
（無限次元空間）（一次元空間）
の調整が必要目的に応じて特徴空間
</p>
</body>
</slide>
<slide page="12">
<body>
<p>
知的画像処理（５） 12
トルとして構成する。次元の新たな特徴ベク
出し，ら，有用な成分を拾い次元原特徴ベクトルか
)(~ dd
d
<
に変換する。次元数の特徴ベクトル
，次元原特徴ベクトルをある基準に基づき， )(~ ddd <
特徴空間の変換
多くの場合，
次元）とする．ル（を変換後の特徴ベクト次元），（
を原特徴ベクトル現．ただし，と，線形変換として表
変換行列
dd
T
~
:,
y
x
AxAy =
特徴空間の低次元化
としてはがある場合，その方法特徴数を削減する必要
</p>
</body>
</slide>
<slide page="13">
<body>
<p>
知的画像処理（５） 13
特徴空間の変換と次元削減(1)
特徴空間の次元削減の基準として，分散最大化基準と平均
二乗誤差最小化基準が一般的に用いられる。
いずれの基準に対しても，ＫＬ展開（主成分分析）による
特徴空間の変換と，それに基づく次元削減が行われる。
分散最大化基準：
変換後の部分空間においてパターン分布の分散が最大に
なるように変換する。
平均二乗誤差最小化基準：
変換前後の誤差の平均二乗誤差が最小になるように，
変換する
</p>
</body>
</slide>
<slide page="14">
<body>
<p>
知的画像処理（５） 14
分散最大基準による次元削減
{ }
が成り立つ．とすると，以下の関係
規直交基底を次元部分空間を張る正変換後の
)~,,1(,,,,,
)(~
~21 diR
dd
d
id LL =∈
<
uuuu
⎩⎨
⎧
≠
== のとき
のとき
ji
ji
ji ,0
,1
uu
( )
次元単位行列．はである．ただし，
は，空間への変換行列元の特徴空間から部分
dI
T
d
~
,,,, ~21 IAAuuuA
A
== L
d
in R∈= xxxxX },,,,{ 21 L特徴ベクトル集合
d
in R
~
21 },,,,{ ∈= yyyyY Lトル集合線形変換後の特徴ベク
X
1ϕ
3ϕ 2ϕ
3y 1y
2y
</p>
</body>
</slide>
<slide page="15">
<body>
<p>
知的画像処理（５） 15
1S部分空間 O
2S部分空間
• M
•
•
•
•
</p>
</body>
</slide>
<slide page="16">
<body>
<p>
知的画像処理（５） 16
mAxAym
ym
xm
T
n
i
i
T
n
i
i
n
i
i
n
i
i
nn
n
n
===
=
=
∑∑
∑
∑
==
=
=
11
1
1
11~
,1~
,1
とすると，
部分空間での平均，
ン平均，原特徴空間でのパター
( ) ( )
( )( )( )
( ) ( )ΣAAAmxmxA
mxAmxA
mxAmxAmymy
AA
T
n
i
T
ii
T
n
i
T
i
T
i
T
n
i
i
TT
i
T
n
i
i
T
i
tr
n
tr
tr
n
nn
A
=⎟⎠
⎞⎜⎝
⎛ −−=
−−=
−−=−−=
∑
∑
∑∑
=
=
==
1
1
11
))((1
)()(1
)()(1)~()~(1)(
)(
σ
σ は散による部分空間での分従って，変換行列
</p>
</body>
</slide>
<slide page="17">
<body>
<p>
知的画像処理（５） 17
∑
=
−−=
n
i
T
iin 1
))((1 mxmxΣ
Σ 列でターン集合の共分散行は，原特徴空間でのパ前式の
( )
IAA
ΣAA
A
A
=T
Ttr
subj.to
:max
を求める問題行列分散を最大にする変換
制約付最適化問題
( ) ラグランジュ関数);(),( AAIΣAAA TTtrL −+= λλ
IAA0A
0uuIΣAΣA0
A
A
=⇒=∂
∂
=−=−⇒=∂
∂
T
d
L
L
λ
λ
λλλ
),(
),,)((222),( ~1 L
等価．（固有方程式）の解と最適化問題の解 0)det( =− IΣ λ
</p>
</body>
</slide>
<slide page="18">
<body>
<p>
知的画像処理（５） 18
と表される．は，対応する固有ベクトル
と，の固有値従って，共分散行列
iiid
dd
uΣuuu
Σ
λ
λλλλ
=
≥≥
,,
)(,,
1
11
L
LL
との関係を行列表現する一方， iii uΣu λ=
( )の最大値は散これより，変換後の分
って，と表すことが可能．従
ΣAAA
IAAΛΣAA
T
TT
tr=
==
)(
)(
2σ
Q
⎟⎟
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜⎜
⎜
⎝
⎛
==⇒=
d
ddd
λ
λ
λ
λλ
L
L
L
L
LL
00
00
00
,),,(),,( 2
1
111 ΛAΛΣAuuuuΣ
を達成する．での変換が分散最大化からなる行列
固有ベクトル個の固有値に対応するの大きい共分散行列
Auu
Σ
d
d
~1 ,,
~
L
{ } { } ∑
=
==
d
i
itr
~
1
2 )(max)(max λσ ΛA
</p>
</body>
</slide>
<slide page="19">
<body>
<p>
知的画像処理（５） 19
i
T
diid
ddiiii
ii
i
T
i
yy
yyy
dd
Ayuu
uuux
xy
xAyA
==
+++=
=×
),,)(,,(
~
~
)~(,
~1~1
~~2211
LL
L
とすると，点をを，原空間で展開した特徴ベクトル
による変換：変換行列
平均二乗誤差最小基準次元削減
d
in R∈= xxxxX },,,,{ 21 L特徴ベクトル集合
d
in R
~
21 },,,,{ ∈= yyyyY Lトル集合線形変換後の特徴ベク
二乗誤差を最小化する
との平均きの，原特徴ベクトル特徴空間から眺めたと
ベクトルを，再度元のによって変換した特徴変換行列A
</p>
</body>
</slide>
<slide page="20">
<body>
<p>
知的画像処理（５） 20
{ } { }
{ }
{ }
{ }
)()(
))(()(1
)(1
)()(1
)()(1||~||)(
)(
1
1
1
1
22
2
RAAR
AxxAxx
xAxAxx
xxAAxxAA
xAyxAyxxA
AA
T
n
i
TT
ii
TT
ii
n
i
i
TT
i
T
i
T
i
n
i
ii
TT
ii
T
n
i
ii
T
ii
trtr
trtr
n
n
n
n
E
−=
−=
−=
−−=
−−=−=
∑
∑
∑
∑
=
=
=
=
ε
ε とすると，による平均二乗誤差を変換
自己相関行列．ここで， :1
1
∑
=
=
n
i
T
iin
xxR
最小化問題上記の平均二乗誤差の
を最大化する問題)( RAATtr
</p>
</body>
</slide>
<slide page="21">
<body>
<p>
知的画像処理（５） 21
T
n
i
T
iin
mmRmxmxΣ
ΣR
−=−−= ∑
=1
))((1
の関係と共分散行列自己相関行列
となる．基準を満たす変換行列は，平均二乗誤差最小
　　
行列
ルに対応する固有ベクト個のこのとき，
),,(
)~,,1(,~
~1 d
i did
uuA L
L
=
=λ
d
d
uuu
R
,,, 21
21
L
L
：対応する固有ベクトル
の固有値：
∑∑
==
=−=
d
di
i
d
i
itr ~
~
1
2 )()}(min{ λλε RA
最小誤差は
λλλ ≥≥≥
</p>
</body>
</slide>
<slide page="22">
<body>
<p>
知的画像処理（５） 22
特徴空間の変換と次元削減(2)
特徴空間の次元削減のもう１つの代表的基準として，線形
判別基準（判別分析基準）がある。
この基準は：
特徴空間と各特徴のクラスが既知である場合，クラス内
分散とクラス間分散の比を最大にするというもの。
線形判別法(Linear Discriminant method)による変換：
ＫＬ展開がパターン全体の分布の最良近似を目的として
いるのに対し，線形判別は識別のためのクラス毎のパタ
ーン分離度を最大化することを目的とする。
特に，２クラスの分類を対象とした方法を，
フィッシャーの方法(Fisher’s method)と呼ぶ。
</p>
</body>
</slide>
<slide page="23">
<body>
<p>
知的画像処理（５） 23
,))(())((
,))((
2121
21
2,1
2,1
21
T
i
T
iiiB
T
i x
iiW
n
nnn
i
mmmmmmmmS
mxmxSSS
−−=−−=
−−=+=
∑
∑∑
=
= ∈ω
フィッシャーの線形判別法
とすると，，平均ベクトルをを
の変動行列のクラス次元特徴ベクトル
ii
i
d iRd
mS
x
)matrixscatter (
)2,1(, =∈ ω
のパターン数は ii
i
i
dT
iii
n
n
R
i
i
ω
ω
ω
,1
,))((
∑
∑
∈
∈
=
∈−−=
x
x
xm
xmxmxS
を，クラス間変動行列
と行列さらに，クラス内変動
B
W
S
S
matrix)scatter  class-(between
matrix)scatter  class-(within
21 nnn +=
</p>
</body>
</slide>
<slide page="24">
<body>
<p>
知的画像処理（５） 24
i
T
Xx
T
i
i
B
T
B
W
T
W
n
mAxAm
ASAS
ASASSS
==
=
=+=
∑
∈
1~
~
~~~
11
の最大化
ASA
ASA
S
S
W
T
B
T
W
B
S AJ == ~
~
)(
xAy T=
する．ように特徴空間を変換対する比を最大化する
内変動にクラス間変動のクラスフィッシャー法では，
は，列行列，クラス間変動行変換後のクラス内変動
とすると，変換行列を
BW SS
A
~,~
BW SS
Sm
Sm
,
,:
,:
222
111
ω
ω
</p>
</body>
</slide>
<slide page="25">
<body>
<p>
知的画像処理（５） 25
を最大化する問題
の下で制約条件：
ASAS
IASAS
B
T
B
W
T
W
=
==
~
~
とおく。で変分してを 0
)()(
A
IASAASAA −−= WTBTJ λ
を正則とする）　
は対称行列
WBW
WB
WB
T
WW
T
BB
SS
S0AISS
0ASAS
0ASSASS
()(
,
)()(
1 =−
=−
=+−+
− λ
λ
λ
のみ．
問題で非零となるのはの中で，２クラス分類
行列から求まる固有値次元の正方行列．このは，
1
21
1 ),(
λ
λλλ d
BW ddSS
≥≥≥
−
L
．ルに対応する固有ベクトは，固有値変換行列 dR∈1λA
の最大化問題：SJ
</p>
</body>
</slide>
<slide page="26">
<body>
<p>
知的画像処理（５） 26
と呼ばれる．
重判別法
正準判別法
形判別法：多クラスへ拡張した線
method)nt discrimina (multiple
method)nt discrimina canonical(
される．次元の特徴空間へ変換判別法では，
に対する線形ラス次元特徴ベクトルのク
)1(~
),,1(,
−≤
=
cd
cid i Lω
とする．列を変換行列対応する固有ベクトル
にの固有値とするとき，行列
を，クラス間共分散行列クラス内共分散行列を
A
ΣΣ
ΣΣ
dBW
BW
~21
1 λλλ ≥≥≥− L
</p>
</body>
</slide>
<slide page="27">
<body>
<p>
知的画像処理（５） 27
(例）２つの異なる２次元正規分布
各１０００点
1C
2C
特徴空間の比較
</p>
</body>
</slide>
<slide page="28">
<body>
<p>
知的画像処理（５） 28
∑
∑
+∈
+∈
−−+=
−−=
+=
21
21
))((1
}))({(
1
21
21
CCx
T
T
X
CC
nn
E
nn
mxmx
mxmxΣ
xm
x 0IΣ =− iX φλ )(
1φ
2φ
xΦy T=変換式：
分散最大化基準に基づく特徴変換
),( 21 φφ=Φ
</p>
</body>
</slide>
<slide page="29">
<body>
<p>
知的画像処理（５） 29
)( 1aA =
線形判別空間
xAy T=変換式：
線形判別分析基準に基づく特徴変換
T
B
T
i C iiW
n
nn
i
))((
))((
,:
,:
2121
21
2,1
222
111
mmmmS
mxmxS
Sm
Sm
x
−−=
−−=∑ ∑= ∈
ω
ω
0aISS =−− iBW )( 1 λ
1a
2a
</p>
</body>
</slide>
<slide page="30">
<body>
<p>
知的画像処理（５） 30
ヒストグラム ヒストグラム
による変換LDA による変換PCA
特徴変換後の第一成分軸への射影
</p>
</body>
</slide>
<slide page="31">
<body>
<p>
知的画像処理（５） 31
特徴空間の高次元化
特徴ベクトルが非線形な構造を有する場合，その解析は
困難．
特徴ベクトルの高次元空間への非線形写像
Txx ),( 21=xトル：（例）２次元特徴ベク
像（５次元特徴化）２次式による非線形写
),,,,(),( 2221
2
12121 xxxxxxxx
T =⇒= Xx
)!1(!
)!1(
−
−+
md
dm
次式の非線形写像次元　　　　原空間：
一般に，
dm
能非線形な相関解析が可
写像空間の次元数： 膨大な計算量が必要
</p>
</body>
</slide>
</presentation>
