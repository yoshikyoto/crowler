<presentation language="ja">
<slide page="1">
<body>
<p>
知的画像処理（６） 1
特徴の照合と
その効率化
</p>
</body>
</slide>
<slide page="2">
<body>
<p>
知的画像処理（６） 2
特徴の照合
２クラス分類問題
：線形識別関数による分類
識別論的照合法
：テンプレートマッチングによる照合
：特徴評価基準による照合
：特徴空間でのマッチングによる照合
構造解析的照合法
：生成文法による照合
：写像およびコスト関数による照合
</p>
</body>
</slide>
<slide page="3">
<body>
<p>
知的画像処理（６） 3
２クラス分類問題
題：の何れかに分類する問
を，２つのクラスパターン次元特徴空間上の特徴 Xx∈d
Xxx
x
x
xwx
Xx
w
∈=
⎩⎨
⎧
<
>=
=+
x
C
C
g
g
wwwd
T
T
T
d
,),1(~
0
0~)~(
)~(
),,,()1(
2
1
10
ただし，
に対してに属する全ての
に対してに属する全ての
線形分離可能である．
は集合が存在するとき，こののような線形識別関数
に対して，以下次元ベクトルある L
の決定が必要．学習による
決定境界面
w
g :0)~( =x
２クラス分類問題と呼ばれる
</p>
</body>
</slide>
<slide page="4">
<body>
<p>
知的画像処理（６） 4
)( 2X特徴２
)( 1X特徴１
（マージン最大化）
　線形識別関数
　0),( 0221121 =−+= aXaXaXXf
能線形（直線で）分離可
２次元特徴空間での分類
</p>
</body>
</slide>
<slide page="5">
<body>
<p>
知的画像処理（６） 5
)( 2X特徴２
)( 1X特徴１
•非線形識別関数を利用
•線形分離能力を高めるため、高次元空間へ写像
対応策
</p>
</body>
</slide>
<slide page="6">
<body>
<p>
知的画像処理（６） 6
)( 1X特徴１
)( 3X特徴３
)( 2X特徴２
0
),,(
0332211
321
=−++= aXaXaXa
XXXf
）線形識別関数（境界面
空間へ写像．を求め，新たな特徴 ),,( 3213 XXXX
まる線形分離の可能性が高
高次元空間への写像
T
T
T
XXX
aaaa
),,,1(~
),,,(
0~
321
3210
=
−=
=
X
w
Xw
</p>
</body>
</slide>
<slide page="7">
<body>
<p>
知的画像処理（６） 7
テンプレートマッチング
画像パターンとテンプレートパターンとの
相互相関係数
正規化相互相関係数
P
N
M
Q
(m,n)
画像：ｆ
テンプレート：ｇ
∑
∈
−−=
Dji
njmigjifnmr
),(
),(),(),(
∑ ∑
∑
∈ ∈
∈
−−
−−
=
Dji Dji
Dji
njmigjif
njmigjif
nmr
),( ),(
2/122/12
),(
norm )],([)],([
),(),(
),(
識別論的照合法(1/3)
</p>
</body>
</slide>
<slide page="8">
<body>
<p>
知的画像処理（６） 8
特徴評価基準による照合
距離測度を用いた照合
最も距離の小さいカテゴリに照合．
類似度を用いた照合
最も類似度の大きいカテゴリに照合．
KL変換，線形判別法による照合
①特徴変換による部分空間への写像（次元圧縮）
②線形判別法による照合
識別論的照合法(2/3)
</p>
</body>
</slide>
<slide page="9">
<body>
<p>
知的画像処理（６） 9
パラメータ空間投票照合
（例）RST変換を受けた特徴の照合法
Rotation
Scaling
Translationiθ θj
Cx Cy(      ,      )
Dx Dy(      ,      )
xB By(      ,      )
AyAx(      ,      )
v i
v j
yyx
xxy
i
j
ij
CsAsAy
CsAsAx
s
+−−=Δ
+−=Δ
=−=
θθ
θθ
θθθ
cossin
cossin
||, v
v
識別論的照合法(3/3)
</p>
</body>
</slide>
<slide page="10">
<body>
<p>
知的画像処理（６） 10
1
2 3
4
5
a
b
c
d
2
1
3
4
5
a
b
c
d
(L,170,220) - (X,100,200)
(T,100,100) - (Y,40,150)
(L,200,100) - (X,220,170)
(L,260,70)   - (X,40,70)
(T,150,125) - (Y,150,50)
(L,545,400) - (X,200,120)
(T,260,240) - (Y,100,245)
(T,140,380) - (Y,300,380)
(L,420,370) - (X,360,500)
T
X
X
Y
L
X
100
0
200
300
100 200 300
T
Y
L
L
0 200 400 600
200
400
600
Y T
T Y
X
L
L
X
•ラベル比較．ラベルに矛盾の無い対を検出
•各対に対して，各パラメータを計算．
•パラメータ空間（4次元 空間）に投票．
•最も投票数の多い座標値を照合結果とする．
),,,( yxs ΔΔθ
モデルベクトル 画像ベクトル
</p>
</body>
</slide>
<slide page="11">
<body>
<p>
知的画像処理（６） 11
る。に３組の対が投票され
)88,75,5.0,6.5(),,,( −=ΔΔ yxsθ
モデルベクトル 画像ベクトル
2
1
3
4
5
a
b
c
d
(L,170,220) - (X,100,200)
(T,100,100) - (Y,40,150)
(L,200,100) - (X,220,170)
(L,260,70)   - (X,40,70)
(T,150,125) - (Y,150,50)
(L,545,400) - (X,200,120)
(T,260,240) - (Y,100,245)
(T,140,380) - (Y,300,380)
(L,420,370) - (X,360,500)
100
0
200
300
100 200 300 0 200 400 600
200
400
600
①
② ③
④
⑤
a
b
c
d
</p>
</body>
</slide>
<slide page="12">
<body>
<p>
知的画像処理（６） 12構造解析的照合手法(1/3)
Syntactic法（構造的情報を形式文法で記述）
パターン）　　　される言語
によって生成文法
(
:)( GGL),,,( SPVVG TN=
：非終端記号集合
：終端記号集合
：生成規則集合
NV
TV
P
S ：開始記号 を定義．　文法
毎にパターンクラス
i
i
G
C
対象物を単純な要素に分割
要素間の関係を文生成規則として表現
</p>
</body>
</slide>
<slide page="13">
<body>
<p>
知的画像処理（６） 13
Syntacticパターン認識システム
サンプル
パターン
文法構築
推論
前処理 パターン表現
構文
解析
認識系
学習系
前処理 パターン表現
分類
識別
　と判定　　
のとき，入力パターン
i
i
Cx
GLx
≈
∈ )(
パターンx
入力
</p>
</body>
</slide>
<slide page="14">
<body>
<p>
知的画像処理（６） 14
写像に基づく構造的記述照合
対象物の構造的記述
:
),( RPD =
関係集合
},,...,,{ 21= nPPPP 要素集合
)}(,,{( 属性名，値属性名，値）L=iP
)},(,),,(),,{( 2211 rr RNRRNRRNR L=R
⎥⎦
⎤⎢⎣
⎡
で構成。
個までの要素集合は、最大nRi
関係を満たす要素集合関係名，　 :: nii PRNR ⊆
構造解析的照合手法(2/3)
</p>
</body>
</slide>
<slide page="15">
<body>
<p>
知的画像処理（６） 15
２つの構造的記述の照合
),( RPDp = ),( SQDc =
,)(.1 jiji QPQPh ⊆= のとき，
)},{(},{ iii RNRRPP == )},{(},{ jjj SNSSQQ ==
において、
yxyxyx ShRSRNSNR ⊆= oが，で，関係 ,.2
．にマッチする』と定義はであるとき、『 pc DD
)},...,1(,)(
 and,),...,(|),...,,{(
:
)(
)()(
121
niQPh
RPPQQQhR
hQPh
i
k
i
k
k
n
k
nk
==
∈=
→
　　　　　　　　　　
を考える．なる写像次のような
o
</p>
</body>
</slide>
<slide page="16">
<body>
<p>
知的画像処理（６） 16
Dc = {C,RC}
C = {C1,C2,C3,C4,C5}
RC = {(Left,Left_C),(Above,Above_C)}
Left_C = {(C1,C4),(C4,C3)}
Above_C = {(C2,C4),(C4,C5)}
C4 = {(shape,circular)}
C5 = {(shape,triangular),(color,black)}
C3 = {(shape,rectangular),(color,black)}
C1 = {(shape,rectangular),(color,white)}
C2 = {(shape,triangular),(color,white)}
P2
P5
C2
P4
P1 P3
C4
C1 C3
C5
Candidate Description DcPrototype Description Dp
Dp = {P,RP}
P = {P1,P2,P3,P4,P5}
RP = {(Left,Left_P),(Above,Above_P)}
Left_P = {(P1,P4),(P4,P3)}
Above_P = {(P2,P4),(P4,P5)}
P2 = {(shape,triangular)}
P3 = {(shape,rectangular)}
P4 = {(shape,circular)}
P5 = {(color black)}
P1 = {(shape,rectangular),(color,white)}
は？ための写像
にマッチするが
h
DD pc（マッチ例）
</p>
</body>
</slide>
<slide page="17">
<body>
<p>
知的画像処理（６） 17
コスト関数によるグラフ照合
２次元関係グラフ ),,,( εμω BN=
：枝集合ノード集合， NNBN ×⊂:
枝のラベル関数，:: BVB→εノードのラベル関数，:: NVN →μ
枝ラベル集合ノードラベル集合， :: BN VV
),,,,( 11111 εμω BN= ),,,( 22222 εμω BN=グラフの照合
の照合と呼ぶ．とを，部分関数
たすとして，次の関係を満
2121
2211
:
{$}{$},
ωωNNf
NNNN
→
∩=∪=
が存在．なるに対し，
が存在．なるに対し，
でに対し，
211111
111121
2212112121
)(
)()3(
.)(),(,)()(,;)2(
$.($))1(
NmmnfNn
NnmnfNm
NnfnfnfnfNnnnn
f
∈=∈
∈=∈
∈≠∈≠
=
構造解析的照合手法(3/3)
</p>
</body>
</slide>
<slide page="18">
<body>
<p>
知的画像処理（６） 18
グラフ変換としての部分関数
置換コストで置換．を ⇒⇒∈=∈ 2122111 )(, nnNnnfNn
削除コストを削除． ⇒⇒=∈ 1111 $.)(, nnfNn
挿入コストを挿入． ⇒⇒=∈ − 22122 $.)(, nnfNn
各変換に必要なコストを定義．
最小コストを持つ変換
2つのグラフの最適マッチングと定義
ノードと枝の置換では，
||),(SUBNODE
1
ii
n
i
i yxg −+∑
=
τσ
と，属性を含めたコスト定義が必要．
</p>
</body>
</slide>
<slide page="19">
<body>
<p>
知的画像処理（６） 19
グラフ照合の例
,1)(DELBRANCH
,2)(INSBRANCH)(DELBRANCH
,1),(SUBNODE),(SUBNODE
},,{,2)DELNODE(
=
==
==
∈=
∗ x
xx
σττσ
τσαα
51112)cost(
$1,53,42:
1
1
=+++=f
f
そのコストは，
，は１つのマッチ関数でaaa
コスト定義例
ω2
ω1
1
3
σ τ
τ
χ
χ
χχ
σ2
4 5
τ
( a ) ( b )
</p>
</body>
</slide>
<slide page="20">
<body>
<p>
知的画像処理（６） 20
照合の効率化
照合回数増や探索空間の巨大化に対する照合の高速化．
(a) DPアルゴリズム．
(b) 遺伝的アルゴリズム．
(c) 発見的探索アルゴリズムなど．
学習に基づく照合の効率化（本講では対象としない）
部分空間法，ニューラルネットワーク，
サポートベクタマシン，隠れマルコフモデル，
ベイジアンネットワークなど,
学習理論
</p>
</body>
</slide>
<slide page="21">
<body>
<p>
知的画像処理（６） 21
DPアルゴリズム
異なる長さのパターンAとB
のマッチングは？
),...,,(),,...,,( 2121 NM bbbBaaaA ==
a1 a2 a3 ai(k)
b2
b1
j(k)b
bN K
s
sk
3s
2s1s
aM
N
M
A
B
から空間上の状態 1- sNM
までの径路決定問題Ks
</p>
</body>
</slide>
<slide page="22">
<body>
<p>
知的画像処理（６） 22
:),(: )()()()( kjkikkjki basbBaA =との対応の要素との要素
で表現．を要素同士の照合コスト )(),( )()( kkjki sdbad =
)]([min),(
1},...,,{ 21
∑
=
=
K
i
isss
sdBAD
K
),(: BADBA の最適照合と
)(},...,,{ 21 kk sgsss に対する部分和部分状態列
)]()([min)]([min)(
1
1},...,{1},...,{ 11
k
k
i
iss
k
i
issk
sdsdsdsg
kk
+== ∑∑ −
==
)]()([min
)]()]([min[min
1}{
1
1},...,{{ 11}
kks
k
k
i
isss
sdsg
sdsd
k
kk
+=
+=
−
−
=
∑
−
状態系列に関する漸化式
</p>
</body>
</slide>
<slide page="23">
<body>
<p>
知的画像処理（６） 23
画像処理へのDP利用
（例）
対１対応．とが分モデル線分ｍと入力線 1i.1
対２対応．とがと分モデル線分ｍと入力線 11-ii.2
対１対応．にとｍが入力線分モデル線分 2i1-m.3
),(1 imd
}),1{,(2 iimd
線分照合戦略 照合コスト
−
)},,1({3 immd −
1 2
3
4
5
6
910
11
12
8
7
INPUT
1 2
3
4
5
6
7
8
MODEL
d1(m,i)d3({m-1,m},i)
d2(m,{i-1,i})
m-2 m-1 m
INPUT
g(m,i)
g(m-2,i-1)
g(m-1,i-2)
g(m-1,i-1)
i-2
i-1
i
MODEL
( b )( a ) ( c )
それぞれの問題を漸化式として表現．
</p>
</body>
</slide>
<slide page="24">
<body>
<p>
知的画像処理（６） 24
⎪⎩
⎪⎨
⎧
−+−−
−+−−
+−−
=
)},,1({3)1,2(
}),1{,(2)2,1(
),(1)1,1(
min),(
immdimg
iimdimg
imdimg
img
DPの漸化式
MODEL
INPUT
1 2 3 4 5 6 7 8 9 10 11 12
2
3
4
5
6
7
8
1
0
ゴール
●：探索点
</p>
</body>
</slide>
<slide page="25">
<body>
<p>
知的画像処理（６） 25
遺伝的アルゴリズム
ある固体集団における生存競争．
生存競争の勝者が生き残り，子孫を残す．
交叉等の過程で生まれた子は親の形質を継承．
世代交代の繰り返し．
環境に適応したものが生き残る．
突然変異により親の形質を継承しない子の発生．
GAの概念
</p>
</body>
</slide>
<slide page="26">
<body>
<p>
知的画像処理（６） 26
GAの処理の流れ
問題のモデル化（遺伝子型の決定）
集団の発生
各個体の環境への適応度計算
環境内での淘汰
子孫生成（増殖，交叉，突然変異）
全体の評価（終了条件）
終了
YES NO
</p>
</body>
</slide>
<slide page="27">
<body>
<p>
知的画像処理（６） 27
パターンマッチングへの応用
重心座標形）個の点列平面上の (nxy
)},(),...,,(),,{( 2211 nn yxyxyxP =
平行移動．倍に拡大，回転，をモデル ),( cc YXMP
モデルP
θ
)},(),...,,(),,{( 2211 nn YXYYYXQ =
⎟⎟⎠
⎞
⎜⎜⎝
⎛+⎟⎟⎠
⎞
⎜⎜⎝
⎛
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −=⎟⎟⎠
⎞
⎜⎜⎝
⎛
c
c
i
i
i
i
Y
X
y
x
M
Y
X
θθ
θθ
cossin
sincos
GAによるマッチングのモデル化
),,,( kkckckk MYXG θ=個体の遺伝子型
)},(),...,,(),,{( 2211 nknkkkkkk YXYXYXE =個体の表現型
</p>
</body>
</slide>
<slide page="28">
<body>
<p>
知的画像処理（６） 28
マッチングの適応度評価
nL
YXf
Efitness
n
i
ikik
k ×=
∑
=1
),(
)(
ってぼかした画像値画像を距離変換によ画像 2:),( yxf
の適応度個体 kE
遺伝子のコーディング
1 0 0 0 11 1 10 01 1
ckX ckY ckM ckθ
遺伝子の交叉
11 10
0 0 0 0 111 11 000
1 11 11 000
11
1
0
0 0 0 0
1
11 11
0
00
1 11 11
0
00
交叉点
（1点交叉の例）
Parent 1
Parent 2
Offspring 1
Offspring 2
G-Length
</p>
</body>
</slide>
<slide page="29">
<body>
<p>
知的画像処理（６） 29
発見的探索アルゴリズム
問題解決と探索：人工知能研究の中核
状態空間
ある問題において到達可能な全ての状態集合．
探索方法
盲目的探索 ・・ 問題固有の情報を用いない．
ヒューリスティック探索 ・・ 探索の制限を行う．
状態空間問題の共通点：最小コスト経路の探索
</p>
</body>
</slide>
<slide page="30">
<body>
<p>
知的画像処理（６） 30
発見的探索法の例・・A*アルゴリズム
グラフ状態探索空間において，部分的に最小コストと
なる節を拡張することで最終状態での最適照合を行う
)()()( *** nhngnf +=
を満たすとき，
がに対し，のコストから目標節点までの真
0)(  and  ),()(
)()(
**
*
>≤ nhnhnh
nhnhn
．経路が決定可能であるを評価することで最適
小コストの推定値．から目標節点に至る最節点
に至るコスト．開始節点から節点
でのコスト評価値．　節点
nnh
nng
nnf
:)(
:)(
:)(
*
*
*
</p>
</body>
</slide>
<slide page="31">
<body>
<p>
知的画像処理（６） 31
前述のコスト関数による全探索空間
5
5
544
4
4
φ{   }
6
0
0
{(1,5)}
f*=4f*=6 f*=5
{(1,$)}
{(1,4),(2,5)}
T1 T2 T3
1 4
{(1,4)}
{(1,4),(2,$)}
{(1,4),(2,5),(3,$)}
{(1,4),(2,$),(3,5)}
{(1,5),(2,4)}{(1,5),(2,$)}
{(1,5),(2,$),(3,4)}
{(1,$),(2,4)}
{(1,$),(2,4),(3,5)}
{(1,$),(2,5)}
{(1,$),(2,5),(3,4)}
{(1,5),(2,4),(3,$)}
2
6
5
．　必要なコストと定義
めに構造的に同じにするた　残りの部分グラフを
：最小コスト推定値 )(* nh
</p>
</body>
</slide>
</presentation>
